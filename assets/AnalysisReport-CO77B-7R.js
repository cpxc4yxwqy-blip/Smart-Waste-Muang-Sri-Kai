import{j as e,Z as u,q as g,l as R,i as S,_ as T,O as _,Q as A,$ as G,R as C,a0 as P,a1 as D}from"./vendor-CpBGEmy5.js";import{r as l,R as E}from"./recharts-BuoUal61.js";import{b as F}from"./geminiService-DSk5TK4c.js";import"./react-B--z-fyW.js";import"./types-BFuqyHc6.js";const W=({records:x,savedIdentities:m,onSaveIdentity:j})=>{const[w,o]=l.useState(""),[n,h]=l.useState(!1),[p,v]=l.useState(!1),[i,N]=l.useState(""),[d,b]=l.useState(""),y=t=>{const a=t.target.value;N(a);const s=m.find(r=>r.name===a);s&&b(s.position)},f=async()=>{h(!0),o(""),i&&j(i,d);try{const t=await F(x);o(t),v(!0)}catch{o("เกิดข้อผิดพลาดในการสร้างรายงาน")}finally{h(!1)}},c=E.useRef(null),k=()=>{var r;if(!c.current)return;const t=document.createElement("iframe");t.style.position="absolute",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);const a=c.current.innerHTML,s=(r=t.contentWindow)==null?void 0:r.document;s&&(s.open(),s.write(`
        <html>
          <head>
            <title>รายงานสรุปสถานการณ์ขยะมูลฝอย</title>
            <script src="https://cdn.tailwindcss.com"><\/script>
            <style>
              @page {
                size: A4;
                margin: 2.54cm;
              }
              body {
                font-family: 'Sarabun', sans-serif;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
              }
              /* Typography adjustments for print */
              h1 { font-size: 24pt; font-weight: bold; margin-bottom: 10px; }
              h2 { font-size: 18pt; font-weight: bold; margin-bottom: 20px; }
              h3 { font-size: 16pt; font-weight: bold; margin-bottom: 10px; }
              p, li { font-size: 14pt; line-height: 1.6; margin-bottom: 10px; color: black; }
              .prose { max-width: 100%; }
              
              /* Hide screen-only elements if any slipped through */
              .no-print { display: none !important; }
            </style>
            <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
          </head>
          <body>
            <div class="print-container">
              ${a}
            </div>
            <script>
              // Wait for fonts and styles to load
              window.onload = () => {
                setTimeout(() => {
                  window.print();
                  // Remove iframe after print dialog closes (approximate)
                  setTimeout(() => {
                    window.frameElement.remove();
                  }, 1000);
                }, 500);
              };
            <\/script>
          </body>
        </html>
      `),s.close())},z=x.length>0;return e.jsx("div",{className:"max-w-5xl mx-auto pb-20",children:e.jsxs("div",{className:"glass-panel rounded-3xl overflow-hidden shadow-glass border border-white/60",children:[e.jsxs("div",{className:"relative bg-gradient-to-r from-indigo-900 to-slate-900 text-white p-10 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-indigo-500 rounded-full -mr-40 -mt-40 opacity-20 blur-[100px]"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-emerald-500 rounded-full -ml-20 -mb-20 opacity-10 blur-[80px]"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/20 text-xs font-semibold text-indigo-100 mb-4 backdrop-blur-md",children:[e.jsx(u,{size:14})," AI Powered Analysis"]}),e.jsx("h2",{className:"text-3xl font-bold mb-3 tracking-tight",children:"Executive Report Generator"}),e.jsx("p",{className:"text-indigo-200/80 max-w-lg font-light leading-relaxed",children:"สร้างรายงานสรุปผลการดำเนินงาน บทวิเคราะห์แนวโน้ม และข้อเสนอแนะเชิงนโยบายสำหรับผู้บริหาร ด้วยระบบ AI อัจฉริยะ Gemini 2.5"})]}),e.jsx("div",{className:"bg-white/10 backdrop-blur-md p-4 rounded-2xl border border-white/10 shadow-lg hidden md:block",children:e.jsx(g,{className:"text-indigo-300 animate-pulse",size:48,strokeWidth:1})})]})]}),e.jsx("div",{className:"bg-white/50 backdrop-blur-sm min-h-[400px] p-10",children:z?e.jsxs(e.Fragment,{children:[!p&&!n&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-lg shadow-indigo-100 transform rotate-3 border border-indigo-50",children:e.jsx(S,{className:"text-indigo-600",size:40})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-3",children:"Ready to Generate Report"}),e.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-12 leading-relaxed",children:"ระบบจะนำข้อมูลสถิติย้อนหลังทั้งหมดมาประมวลผล เพื่อจัดทำเอกสารสรุปสถานการณ์ประจำเดือน"}),e.jsxs("div",{className:"max-w-lg mx-auto mb-10 text-left bg-white p-6 rounded-2xl border border-slate-100 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500"}),e.jsxs("h4",{className:"text-sm font-bold text-slate-800 mb-5 flex items-center gap-2",children:[e.jsx(T,{size:16,className:"text-indigo-500"})," ข้อมูลผู้จัดทำ (Optional)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"ชื่อ-นามสกุล"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",list:"reporter-names",value:i,onChange:y,className:"w-full pl-9 p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium focus:bg-white focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all",placeholder:"ชื่อผู้จัดทำ"})]}),e.jsx("datalist",{id:"reporter-names",children:m.map((t,a)=>e.jsx("option",{value:t.name},a))})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"ตำแหน่ง"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",value:d,onChange:t=>b(t.target.value),className:"w-full pl-9 p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium focus:bg-white focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all",placeholder:"ระบุตำแหน่ง"})]})]})]})]}),e.jsxs("button",{onClick:f,className:"group relative px-8 py-4 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-2xl font-bold shadow-xl shadow-indigo-500/20 hover:shadow-indigo-500/40 hover:-translate-y-1 transition-all overflow-hidden mx-auto flex items-center gap-3",children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 group-hover:translate-x-full transition-transform duration-700 skew-x-12 -ml-4"}),e.jsx(g,{size:20}),"Generate AI Report"]})]}),n&&e.jsxs("div",{className:"py-32 text-center",children:[e.jsxs("div",{className:"relative mx-auto w-20 h-20 mb-8",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-indigo-100 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-indigo-600 rounded-full border-t-transparent animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(u,{className:"text-indigo-600 animate-pulse",size:24})})]}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Analyzing Data..."}),e.jsx("p",{className:"text-slate-400 font-medium",children:"กรุณารอสักครู่ AI Gemini กำลังเขียนรายงาน"})]}),p&&!n&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between mb-8 border border-indigo-100 bg-indigo-50/50 p-6 rounded-2xl gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-green-500 text-white p-3 rounded-xl shadow-md shadow-green-500/20",children:e.jsx(G,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Report Generated Successfully"}),e.jsxs("p",{className:"text-xs text-slate-500 font-medium",children:["Created on ",new Date().toLocaleString("th-TH")]})]})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs("button",{onClick:f,className:"flex-1 md:flex-none justify-center text-slate-500 hover:text-slate-700 hover:bg-white px-4 py-2.5 rounded-xl font-bold flex items-center gap-2 transition-colors border border-transparent hover:border-slate-200",children:[e.jsx(C,{size:16}),"Regenerate"]}),e.jsxs("button",{onClick:k,className:"flex-1 md:flex-none justify-center bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2.5 rounded-xl font-bold flex items-center gap-2 transition-all shadow-lg shadow-indigo-500/20",children:[e.jsx(P,{size:18}),"Print / Save PDF"]})]})]}),e.jsxs("div",{ref:c,className:"bg-white p-8 md:p-12 rounded-3xl shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"text-center mb-10 hidden print-block",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{style:{width:"80px",height:"80px",margin:"0 auto",background:"url(https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Garuda_Emblem_of_Thailand_%28Old_Version%29.svg/1200px-Garuda_Emblem_of_Thailand_%28Old_Version%29.svg.png) center/contain no-repeat"}})}),e.jsx("h1",{className:"text-3xl font-bold mb-2 text-black",children:"บันทึกข้อความ"}),e.jsx("h2",{className:"text-xl font-bold mb-6 text-black",children:"ส่วนราชการ เทศบาลตำบลเมืองศรีไค อำเภอวารินชำราบ จังหวัดอุบลราชธานี"}),e.jsxs("div",{className:"flex justify-between text-base mb-6 border-b-2 border-black pb-6 font-medium",children:[e.jsx("span",{children:"ที่ ....................................."}),e.jsxs("span",{children:["วันที่ ",new Date().toLocaleDateString("th-TH",{day:"numeric",month:"long",year:"numeric"})]})]}),e.jsx("h3",{className:"text-xl font-bold text-left mb-2 text-black",children:"เรื่อง รายงานสรุปสถานการณ์ขยะมูลฝอยประจำเดือน"}),e.jsx("div",{className:"text-left text-lg text-black",children:"เรียน นายกเทศมนตรีตำบลเมืองศรีไค"})]}),e.jsx("style",{children:`
                          .print-block { display: none; }
                        `}),e.jsx("style",{children:`
                          /* Force display block inside the iframe context */
                          .print-container .print-block { display: block !important; }
                        `}),e.jsx("div",{className:"prose prose-slate prose-lg max-w-none prose-headings:font-bold prose-headings:text-indigo-950 prose-h2:text-2xl prose-h3:text-xl prose-p:text-slate-700 prose-p:leading-loose prose-li:text-slate-700 text-justify",children:e.jsx(D,{children:w})}),e.jsx("div",{className:"mt-20 pt-10 border-t border-slate-100 flex flex-col items-end",children:e.jsxs("div",{className:"text-center w-72",children:[e.jsx("div",{className:"mb-12 text-slate-400 border-b border-slate-300 w-full mx-auto"}),e.jsxs("p",{className:"font-bold text-slate-800 text-lg",children:["(",i||"................................................",")"]}),e.jsx("p",{className:"text-slate-500",children:d||"ตำแหน่ง ................................................"}),e.jsx("p",{className:"text-slate-400 text-sm mt-2",children:"ผู้จัดทำรายงาน"})]})})]})]})]}):e.jsxs("div",{className:"text-center py-16 bg-white/60 rounded-3xl border border-dashed border-slate-200",children:[e.jsx("div",{className:"w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6 text-red-400",children:e.jsx(R,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-700 mb-2",children:"No Data Available"}),e.jsx("p",{className:"text-slate-500",children:"กรุณาบันทึกข้อมูลลงในระบบก่อนใช้งานฟังก์ชันนี้"})]})})]})})};export{W as default};
